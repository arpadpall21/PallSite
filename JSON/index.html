<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title> JSON </title>    
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous"> 
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link rel="stylesheet" href="../Assets/stylesPages.css">
    <script src="../Assets/scriptPages.js"></script>
</head>
<body>
<h1> JSON (ver 4.0.0) </h1>
    <p> Updated (2018-07-24 / 2018-08-06 / 2019-05-24 / 2021-02-16)</p>
    <p class="sitenav"> <a href="../index.html">MySite></a> JSON </p>
<table class="table">
<caption>
    <span class="changeListOrder">[Ordered: <span>Alphabetically</span>]</span>
</caption>
    <tr>
        <th> Methods </th>
        <th> Value </th>
    </tr>
    <tr class="02">
        <td> 
            <em>JSON</em>.parse(<strong>jsonData</strong>, <i class="openable">fn(key, value)<div>
            <p> - callback executed for every key-value pair (callback used to filter values while parsing) </p>
            <p> - must return the current value </p>
        </div></i>) </td>
        <td> 
            - converts JSON data into JavaScript data 
            <span id="browserSupport" title="updated : 2019-05-24">
                <span><i class="fab fa-chrome"></i> yes </span>
                <span><i class="fab fa-firefox"></i> 3.5 </span>
                <span><i class="fab fa-opera"></i> 10.5 </span>
                <span><i class="fab fa-internet-explorer"></i><i class="fab fa-edge"></i> 8 </span>
                <span><i class="fab fa-safari"></i> 4 </span>
                <span><i class="fab fa-node-js"></i> yes </span>
            </span>
        </td>
    </tr>
    <tr class="01">
        <td> 
            <em>JSON</em>.stringify(<strong>jsData</strong>, <i class="openable">fn(key, val)|[key:str, ...]<div>
            <p> <i>fn(key, val) </i> </p>
            <p> - callback executed for every key-value pair (callback used to filter values while stringifying) </p>
            <p> - must return the current value <u>(for the first pass the <mark>val</mark> is the received full <strong>jsData</strong></u> </p>
            <hr>
            <p> <i>[key:str, ...]</i> - array with the source object keys as string </p>
            <p> - only these specified keys well be parsed to JSON </p>
            <p> - EX: source object <mark>{p1:21, p2:22, p3:23}</mark> parsed with <mark>JSON.stringify({p1:21, p2:22, p3:23}, ['p1', 'p2'])</mark> results in <mark>'{"p1":21, "p2":22}'</mark> </p>
        </div></i>, <i class="openable">space:str|nr<div>
            <p> - <i>str</i> - string inserted between each of the parsed key/value pairs </p>
            <p> - <i>nr</i> - number of white spaces inserted between each of the parsed key/value pairs </p>
            <p> - (Default: <mark>null</mark>) </p>
            <p> - EX: source object <mark>{p1:21, p2:22, p3:23}</mark> parsed with <mark>JSON.stringify({p1:21, p2:22, p3:23}, null, '**')</mark> results in <mark>{**"p1": 21,**"p2": 22,**"p3": 23}</mark> </p>
        </div></i>) 
        </td>
        <td> 
            - converts JavaScript data into a JSON data 
            
            <span id="browserSupport" title="updated : 2019-05-24">
                <span><i class="fab fa-chrome"></i> yes </span>
                <span><i class="fab fa-firefox"></i> 3.5 </span>
                <span><i class="fab fa-opera"></i> 10.5 </span>
                <span><i class="fab fa-internet-explorer"></i><i class="fab fa-edge"></i> 8 </span>
                <span><i class="fab fa-safari"></i> 4 </span>
                <span><i class="fab fa-node-js"></i> yes </span>
            </span>
        </td>
    </tr>
</table>
<h2 style="color:green;"><u> Notes : </u></h2>
    <details class="example" id="notes">
    <summary> Notes :</summary>
    </details>
<h2 style="color:green;"><u> Useful Links : </u></h2>
    <p><a href="https://www.w3schools.com/js/js_json_intro.asp" target="_blank"> W3School JSON </a></p>
    <p><a href="https://www.json.org/" target="_blank"> JSON.org </a></p>
<h2 style="color:green;"><u> Remember This : </u></h2>
    <p> - JSON strings must be written with <mark>"</mark> double quotes</p>
    <p> - JSON transported data is only <u>String</u> <b>VS</b> Structured Data Algorithm (HTML5) can be nearly any data type </p>
    <p> - the <mark>stringify()</mark> and <mark>parse()</mark> methods' replacer function can modify values only! (keys cannot be modified) </p>
<h2 style="color:green;"><u> Description and Demonstration : </u></h2>
    <p> - JSON is an <u>independent</u> (any programing language can use it) lightweight data format for storing and exchanging data </p>
    <p> - JSON stands for <b>J</b>ava<b>S</b>cript <b>O</b>bject <b>N</b>otation </p>
    <p> - The exchanged Data between the browser and the server can be <u style="background-color:yellow; font-weight:bold;">ONLY STRING</u> </p>
    <p> - The JSON file format is <mark>.json</mark> and MIME (<mark>M</mark>ultipurpose <mark>I</mark>nternet <mark>M</mark>ail <mark>E</mark>xtensions) type is <mark>application/json</mark> </p>
<!---------------------------------------------------------------------------------------------------------------------------->    
<hr>    
<h2 style="color:darkblue;"><u> Supported Data Structure and Values </u></h2>
    <p> - JSON supports two data formats, Object and Array </p>
    <pre class="syntax">
SYNTAX :    {<i>"string":value</i>, <i>"string":value</i>, <i>...</i>}                     &lt;-- JSON Object <span style="color:yellow">(accept double quotes only!)</span>
            [<i>value</i>, <i>value</i>, <i>...</i>]                                       &lt;-- JSON Array
            
<span style="color:lightgreen; font-size:1.1em; font-weight:bold;">Supported Values</span>          --&gt;  <span style="color:lightgreen;">string</span> | <span style="color:lightgreen;">number</span> | <span style="color:lightgreen;">boolean</span> | <span style="color:lightgreen;">null</span>
                                
<span style="color:orange; font-size:1.1em; font-weight:bold;">NOT Supported Values</span>      --&gt;  <span style="color:orange;">undefined</span> | <span style="color:orange;">symbol key</span> | <span style="color:orange;">function</span>    <span style="color:yellow">&lt;-- completely ignored upon conversion </span>    
                            --&gt;  <span style="color:orange;">infinity</span> | <span style="color:orange;">NaN</span>                       <span style="color:yellow">&lt;-- converted as</span> <span style="color:lightgreen">null</span>
                            --&gt;  <span style="color:orange;">date object</span>                          <span style="color:yellow">&lt;-- convertes as</span> <span style="color:lightgreen">date string</span>
    </pre> 
<details class="example">
<summary> DEMO </summary>
    <pre>
 -> JavaScript Object                   -> JSON Object (you can create JSON Object on the fly in JavaScript like this)
    {p1:"myString"                      '{"p1":"myString",
     
     p2:13.45,                            "p2":13.45,
     p3:14e+1,                            "p3":140,                             // exponential notataion is converted to a regular number
     p4:0142,                             "p4":98                               // -! octal notation is converted to decimal  
     
     p5:true,                             "p5":ture,
     
     p6:null,                             "p6":null,
     p7:NaN,                              "p7":null,                            // NaN converted to null
     p8:Infinity,                         "p8":null,                            // Infinity converted to null
     
     p9:function(){ return: 44 },                                               // function Ignored!
     p10:undefined,                                                             // undefined Ignored!
     p11:new Date();                      "p11":dateString;                     // date converted into a date string                       
    };                                  }'           
    </pre>
</details>
<!---------------------------------------------------------------------------------------------------------------------------->    
<hr>
<h2 style="color:darkblue;"><u> Working with JSON data in JavaScript </u></h2>    
    <p> - because JSON is derived form JavaScript we use JavaScript Syntax to work with JSON data </p>
    <pre>
// create JSON Object
    var JSON_Obj = '{"p1":"val1", "p2":21, "pC":true}'
    
    JSON_Obj.p1;                                                                       // -> "val1"
    
    JSON_Obj["prop_B"] = null;                                                  
    JSON_Obj["p2"];                                                                    // -> null
    
    delete JSON_Obj.p3;
    JSON_Obj.prop_C;                                                                   // -> undefined
    </pre>
<details class="example">
<summary> Example : </summary>
<h4><u> Looping through JSON Objects </u></h4>
    <p id="printJSON"></p>
<script>
// Object
    var myObj_JSON = {"prA":"myString", "prB":47, "prC":true, "rpD":false};     // JSON Object created
    var myArr_JSON = ["myString", 47, true, false];                             // JSON Array same as JavaScript
    
// print
    // Object looped through as a normal JS object
    for(let i in myObj_JSON) {
        document.getElementById('printJSON').innerHTML += myObj_JSON[i] + " ";
    }
    // Array is an Iterable Object
    for(let k of myArr_JSON) {
        document.getElementById("printJSON").innerHTML += " " + k;
    }
</script>
        <details>
        <summary> CODE : </summary>
        <pre>
    &lt;p id="printJSON"&gt;&lt;/p&gt;
&lt;script&gt;
// Object
    var myObj_JSON = {"prA":"myString", "prB":47, "prC":true, "rpD":false};     // JSON Object created
    var myArr_JSON = ["myString", 47, true, false];                             // JSON Array same as JavaScript
    
// print
    // Object looped through as a normal JS object
    for(let i in myObj_JSON) {
        document.getElementById('printJSON').innerHTML += myObj_JSON[i] + " ";
    }
    // Array is an Iterable Object
    for(let k of myArr_JSON) {
        document.getElementById("printJSON").innerHTML += " " + k;
    }
&lt;/script&gt;    
        </pre>
        </details>
</details>    
<!---------------------------------------------------------------------------------------------------------------------------->    
<hr>
<h2 style="color:darkblue;"><u> JSON Methods <mark>.stringify()</mark> / <mark>parse()</mark> </u></h2>      
<details class="example">
<summary> DEMO </summary>
    <pre>
    var myObj = {p1:'myString', p2:21, p3:true, p4:null, p5:undefined};
    
// stringify() -----------------------------------------------------------------
    JSON.stringify(myObj);                                                      // -> {"p1":"myString", "p2":21, "p3":true, "p4":null}     // -! undefined in not supported 
    
   // filtering with select Array ----------------------------------------------
    JSON.stringify(myObj, ['p2', 'p3']);                                        // -> {"p2":21, "p3":true}      // only the specified key/value pairs are stringified  
                                                
   // filtering with callback function -----------------------------------------
    var jsonData = JSON.stringify(myObj, function(key, value){                  // -> {   "p1":"first",   "p2":21,   "p3":true,   "p4":null}
        if(key == 'p1') value = 'first';                                        // values can be modified 
        if(key == 'p2') key = "az";                                             // -! keys cannot be modified (this has no effect)
        return value;                                                           // !! the value MUST be returned at every pass!  
    }, 3);                                                                      // 3 white spaces are inserted between key/value paris      // -! this is for readability purposes only does not have any effect on the transformed data   
    
// parse() ---------------------------------------------------------------------
    JSON.parse(jsonData);                                                       // -> {p1:"blah", p2:21, p3:true, p4:null}
    
    // fitlering with callback function ----------------------------------------
    JSON.parse(result, function(key, value){                                    // -> {p1:"blah", p2:22, p3:true, p4: null}
        if(key == 'p2') value = 22;                                             // valuse can be modified 
        if(key == 'p4') key = 'last';                                           // -! keys cannot be modified (this has no effect)
        return value;                                                           // !! the value MUST be returned at every pass!
    })
    </pre>
</details>
<details class="example">
<summary> Example : </summary>
<h4><u> converting </u></h4>
<script>
    var objJS = {prop_A:"stringVal", prop_B:475, prop_C:true};      // JS Object
    var arrJS = ["stringVal", false, null];                         // JS Array
    
// JS to JSON
    var objJSON = JSON.stringify(objJS);                            // JSON Object
    var arrJSON = JSON.stringify(arrJS);                            // JSON Array
    
// JSON to JS 
    var objJS_again = JSON.parse(objJSON);
    var arrJS_again = JSON.parse(arrJSON);
</script>
        <details>
        <summary> CODE : </summary>
        <pre>
&lt;script&gt;
    var objJS = {prop_A:"stringVal", prop_B:475, prop_C:true};      // JS Object
    var arrJS = ["stringVal", false, null];                         // JS Array
    
// JS to JSON
    var objJSON = JSON.stringify(objJS);                            // JSON Object
    var arrJSON = JSON.stringify(arrJS);                            // JSON Array
    
// JSON to JS 
    var objJS_again = JSON.parse(objJSON);
    var arrJS_again = JSON.parse(arrJSON);
&lt;/script&gt;
        </pre>
        </details>
<h4><u> filtering </u></h4>
    <p id="filterStringify"></p>
<script>
    var myPro;
    var testObj = {pr1:"str", pr2:32, pr3:true, pr4:null};
    var converted = JSON.stringify(testObj, replacer, " *** ");     // the 3rd argument can upgrad readability
    var converted_2 = JSON.stringify(testObj, ["pr2", "pr4"]);      // an Array simply filters the targeted keys
   
    function replacer(key, value) {
        if(key === "pr1") {                        
            return key = "myProp";                                  // keys cannot be changed only values!
        }
        else if(value === 32) {
            return value = 33;
        }
        else if(key === "pr3") {                                    // JSON filters out "undefined" data type
            return undefined;
        }
        else { 
            return value;                                           // at the end the value argument must be returned
        };
    }
    
// print
    document.getElementById("filterStringify").innerHTML = 
        "Original Obj = " + JSON.stringify(testObj) + "<br>" +
        "Replaceing values with the \"Replacer\" function = " + converted + "<br>" +
        "Filtering with an Array = " + converted_2;
</script>    
        <details>
        <summary> CODE : </summary>
        <pre>
    &lt;p id="filterStringify"&gt;&lt;/p&gt;
&lt;script&gt;
    var myPro;
    var testObj = {pr1:"str", pr2:32, pr3:true, pr4:null};
    var converted = JSON.stringify(testObj, replacer, " *** ");     // the 3rd argument can upgrad readability
    var converted_2 = JSON.stringify(testObj, ["pr2", "pr4"]);      // an Array simply filters the targeted keys
   
    function replacer(key, value) {
        if(key === "pr1") {                        
            return key = "myProp";                                  // keys cannot be changed only values!
        }
        else if(value === 32) {
            return value = 33;
        }
        else if(key === "pr3") {                                    // JSON filters out "undefined" data type
            return undefined;
        }
        else { 
            return value;                                           // at the end the value argument must be returned
        };
    }
    
// print
    document.getElementById("filterStringify").innerHTML = 
        "Original Obj = " + JSON.stringify(testObj) + "&lt;br&gt;" +
        "Replaceing values with the \"Replacer\" function = " + converted + "&lt;br&gt;" +
        "Filtering with an Array = " + converted_2;
&lt;/script&gt;    
        </pre>
        </details>
<h4><u> JSON to JavaScript </u></h4>     
<script>
    var objObj = {p1:"value", p2:78, p3:true, p4:null};
    var jsoned = JSON.stringify(objObj);
    var back_to_jsObj = JSON.parse(jsoned, reviverFn);          // returns "{p1:"modifiedValue", p2:0, p4:null}"
    
    function reviverFn(key, value) {
        if (key == "p1") {
            return value = "modifiedValue";
        }
        else if (value == 78) {
            return key = 0;                     // keys cannot be changed!
        }
        else if (key == "p3") {
            return value = undefined;           // filtered out!
        }
        else {
            return value;                       // value must be returned at the end!
        }
    }
</script>
        <details>
        <summary> CODE : </summary>
        <pre>
&lt;script&gt;
    var objObj = {p1:"value", p2:78, p3:true, p4:null};
    var jsoned = JSON.stringify(objObj);
    var back_to_jsObj = JSON.parse(jsoned, reviverFn);          // returns "{p1:"modifiedValue", p2:0, p4:null}"
    
    function reviverFn(key, value) {
        if (key == "p1") {
            return value = "modifiedValue";
        }
        else if (value == 78) {
            return key = 0;                     // keys cannot be changed!
        }
        else if (key == "p3") {
            return value = undefined;           // filtered out!
        }
        else {
            return value;                       // value must be returned at the end!
        }
    }
&lt;/script&gt;
        </pre>
        </details>
</details>    
<!---------------------------------------------------------------------------------------------------------------------------->    
<hr>
<h2 class="headerExtra"><u> Dealing with Not supported JSON data  </u></h2>      
    <p> - <mark>undefined</mark> is ignored in JSON (it can be used to filter out values) </p>
    <p> - <mark>Symbols</mark> are completely ignored in JSON </p>
    <p> - <mark>function()</mark>s are ignored in JSON <span style="color:yellow;">(can be passed as string and converted back with the <mark>eval()</mark> method but it is not recommended!)</span> </p>
    <p> - <mark>Date()</mark>s are converted into a string automatically in JSON (this date string can be used to convert the data back to <mark>new Date()</mark>) </p>
<details class="example">
<summary> DEMO </summary>
    <pre>
    var mySymbol = Symbol("symb1");
    var myObj = {prop1:undefined, prop2:function() {return 54}, prop3:new Date()};
    myObj[mySymbol] = "symbolValue";                                            // add the symbol to the object 
    
// the date is converted into a string and all other data is lost!
    var objJSON = JSON.stringify(myObj);                                        // -> "{"prop3":"2018-08-06T15:14:48.858Z"}"
    </pre>
</details>
<details class="example">
    <summary> Example : </summary>
<h4><u> not supported data conversion </u></h4>
    <p id="conversion"></p>
<script>
    var mySymbol = Symbol("symb1");
    var printCont = "";
    var mixObj = {
                  property_1:"myValue",
                  property_2:new Date(2018, 08, 06),                // date Object will be converte into a string
                  property_3:undefined,                             // undefined is ignored
                  property_4:function() {return "I'm retourned"}    // function is ignored
                 };
    mixObj[mySymbol] = "symbol value";                              // Symbol added to the object but ignored by JSON entierly
    var jsonEd = JSON.stringify(mixObj);
    printCont += "JSON stringify = " + jsonEd + "<br>";
    
// when the object is converted back to JavaScript these data types are lost!
    var reconvert = JSON.parse(jsonEd);     // reconverte = {property_1: \"myValue\", property_2: \"2018-09-05T21:00:00.000Z\"}
    printCont += "reconverted lost data = " + "{property_1: \"myValue\", property_2: \"2018-09-05T21:00:00.000Z\"}";
    
// print
    document.getElementById("conversion").innerHTML = printCont;
</script>
        <details>
        <summary> CODE : </summary>
        <pre>
    &lt;p id="conversion"&gt;&lt;/p&gt;
&lt;script&gt;
    var mySymbol = Symbol("symb1");
    var printCont = "";
    var mixObj = {
                  property_1:"myValue",
                  property_2:new Date(2018, 08, 06),                // date Object will be converte into a string
                  property_3:undefined,                             // undefined is ignored
                  property_4:function() {return "I'm retourned"}    // function is ignored
                 };
    mixObj[mySymbol] = "symbol value";                              // Symbol added to the object but ignored by JSON entierly
    var jsonEd = JSON.stringify(mixObj);
    printCont += "JSON stringify = " + jsonEd + "&lt;br&gt;";
    
// when the object is converted back to JavaScript these data types are lost!
    var reconvert = JSON.parse(jsonEd);     // reconverte = {property_1: \"myValue\", property_2: \"2018-09-05T21:00:00.000Z\"}
    printCont += "reconverted lost data = " + "{property_1: \"myValue\", property_2: \"2018-09-05T21:00:00.000Z\"}";
    
// print
    document.getElementById("conversion").innerHTML = printCont;
&lt;/script&gt;
        </pre>
        </details>
<h4><u> solution for not supported data in JSON </u></h4>
    <p id="reConvert"></p>
<script>
    var supportObj = {date:new Date(),
                      method:"function() {return 'Im returned'}"       // function stored as a string
                     };
    var toJSON = JSON.stringify(supportObj);
    var reConvert = JSON.parse(toJSON);
    reConvert.method = eval("(" + reConvert.method + ")");              // evaluate a string as an object PARANTHESES ARE REQUIRED!
                                                                        // reassign the ready function
    
// print
    document.getElementById('reConvert').innerHTML = 
        "recover date = " + new Date(reConvert.date) + "<br>" +         // string converted back to Date
        "recover method = " + reConvert.method();                       // calling the function
</script>
        <details>
        <summary> CODE : </summary>
        <pre>
    &lt;p id="reConvert"&gt;&lt;/p&gt;
&lt;script&gt;
    var supportObj = {date:new Date(),
                      method:"function() {return 'I'm retourned'}"       // function stored as a string
                     };
    var toJSON = JSON.stringify(supportObj);
    var reConvert = JSON.parse(toJSON);
    reConvert.method = eval("(" + reConvert.method + ")");              // evaluate a string as an object PARANTHESES ARE REQUIRED!
                                                                        // reassign the ready function
    
// print
    document.getElementById('reConvert').innerHTML = 
        "recover date = " + new Date(reConvert.date) + "<br>" +         // string converted back to Date
        "recover method = " + reConvert.method();                       // calling the function
&lt;/script&gt;
        </pre>
        </details>
</details>    
    
    <br><br>
</body>
</html>