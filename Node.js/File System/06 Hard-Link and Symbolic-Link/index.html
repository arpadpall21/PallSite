<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title> Hard-Link and Symbolic-Link (Soft-Link) </title> 
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous"> 
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link rel="stylesheet" href="../../../Assets/stylesPages.css"> 
    <script src="../../../Assets/scriptPages.js"></script>
</head>
<body>
<h1> Hard-Link and Symbolic-Link (Soft-Link) (ver 3.4.1) </h1>
    <p> Updated ( 2019-10-07 / 2020-06-30)</p>
    <p class="sitenav"> <a href="../../../index.html">MySite></a>
        <a href="../../index.html">Node.js></a>  
        <a href="../index.html">File System></a> Hard-Link and Symbolic-Link  
    </p>
<table class="table">
<caption> Symbolic-Link and Hard-Link </caption>
    <tr>
        <th style="width:30%;"> Method  </th>
        <th> Description </th>
    </tr>
    <tr>
        <td> <strong>fs</strong>.link(<strong>path:str|buf|urlObj</strong>, <strong>hardLink:str|buf|urlObj</strong>, <strong>fn(err)</strong>) </td>
        <td> asynchronoulsy creates a hard-link of the original file (directory hard-links are not allowed)   
        </td>
    </tr>
    <tr>
        <td> <strong>fs</strong>.linkSync(<strong>path:str|buf|urlObj</strong>, <strong>hardLink:str|buf|urlObj</strong>) </td>
        <td> synchronously creates a hard-link of the original file (directory hard-links are not allowed)
            <span id="browserSupport" title="updated : 2020-06-30">
                <span><i class="fab fa-node-js"></i> 0.1.31 </span>
                <span class="openable"><i class="fab fa-node-js"></i> more... <div>
                    <p> - 7.6.0 - WHATWG <mark>URL</mark> support </p>
                </div></span>
            </span>
        </td>
    </tr>
    <tr>
        <td> <strong>fs</strong>.readlink(<strong>symLinkPath:str|buf|urlObj</strong>, <i>encode:str</i>, <strong>fs(err, link)</strong>) </td>
        <td> asynchronously returns the path where the symbolic-link is pointing to (in the callback)
            <span id="browserSupport" title="updated : 2020-06-30">
                <span><i class="fab fa-node-js"></i> 0.1.31 </span>
                <span class="openable"><i class="fab fa-node-js"></i> more... <div>
                    <p> - 7.0.0 - callback required </p>
                    <p> - 7.6.0 - WHATWG <mark>URL</mark> support </p>
                </div></span>
            </span>
        </td>
    </tr>
    <tr>
        <td> <strong>fs</strong>.readlinkSync(<strong>symLinkPath:str|buf|urlObj</strong>, <i>encode:str</i>) </td>
        <td> synchronously returns the path where the symbolic-link is pointing to
            <span id="browserSupport" title="updated : 2020-06-30">
                <span><i class="fab fa-node-js"></i> 0.1.31 </span>
                <span class="openable"><i class="fab fa-node-js"></i> more... <div>
                    <p> - 7.6.0 - WHATWG <mark>URL</mark> support </p>
                </div></span>
            </span>
        </td>
    </tr>
    <tr>
        <td> 
            <strong>fs</strong>.symlink(<strong>targPath:str|buf|urlObj</strong>, <strong>symLinkPath:str|buf|urlObj</strong>, <i class="openable">type:str<div>
                <p> <mark>'file'</mark> <mark>'dir'</mark> <mark>'junction'</mark>, if not set 'file' or 'dir' automatically detected / 'junction' = will resolve the <strong>targPath</strong> to absolute path (directory only) <u>(Windows only!)</u> </p>
            </div></i>, <strong>fs(err)</strong>) 
        </td>
        <td> 
            asynchronously creates a symbolic-link to a file or directory <u>(the target path (<strong>targPath</strong>) must be relative to the symbolic-link)</u>
            <span id="browserSupport" title="updated : 2020-06-30">
                <span><i class="fab fa-node-js"></i> 0.1.31 </span>
                <span class="openable"><i class="fab fa-node-js"></i> more... <div>
                    <p> - 7.6.0 - WHATWG <mark>URL</mark> support </p>
                    <p> - 12.0.0 - auto detect <i>type</i> argument ('file' of 'dir') </p>
                </div></span>
            </span>
        </td>
    </tr>
    <tr>
        <td>   
            <strong>fs</strong>.symlinkSync(<strong>targPath:str|buf|urlObj</strong>, <strong>symLinkPath:str|buf|urlObj</strong>, <i class="openable">type:str<div>
                <p> <mark>'file'</mark> <mark>'dir'</mark> <mark>'junction'</mark>, if not set 'file' or 'dir' automatically detected / 'junction' = will resolve the <strong>targPath</strong> to absolute path (directory only) <u>(Windows only!)</u> </p>
            </div></i>) 
        </td>
        <td> synchronously creates a symbolic-link to a file or directory <u>(the target path (<strong>targPath</strong>) must be relative to the symbolic-link)</u>  
            <span id="browserSupport" title="updated : 2020-06-30">
                <span><i class="fab fa-node-js"></i> 0.1.31 </span>
                <span class="openable"><i class="fab fa-node-js"></i> more... <div>
                    <p> - 7.6.0 - WHATWG <mark>URL</mark> support </p>
                    <p> - 12.0.0 - auto detect <i>type</i> argument ('file' of 'dir') </p>
                </div></span>
            </span>
        </td>
    </tr>
</table>
<h2 style="color:green;"><u> Notes : </u></h2>
    <details class="example" id="notes">
    <summary> Notes :</summary>
        <p> - symbolic-links point to a file (or another symbolic-link) simply, if I replace the file (with the same name) the new file will be referenced [TESTED: 2020-06-30] </p>
    </details>
<h2 style="color:green;"><u> Useful Links : </u></h2>
    
<h2 style="color:green;"><u> Remember This : </u></h2>
    
<h2 style="color:green;"><u> Description and Demonstration : </u></h2>
    <img src='./simbolic-link VS hard-link.jpg' alt='Symbolic-link VS Hard-Link.jpg'>
<h2 class="headerExtra"><u> Symbolic-Link (Soft-Link) </u></h2>
<h2 style="color:darkblue;"><u> The <mark>symlink()</mark> / <mark>symlinkSync()</mark> / <mark>readlink()</mark> / <mark>readlinkSync()</mark> methods </u></h2>
    <p> - a Symbolic-Link or Soft-Link is a shortcut item which targets the original <u>file or directory anywhere in the local computer or through the network</u> </p>
    <p> - symbolic-links can be chained, but the chain can be broken by removing a file (ex: <mark>file</mark>-<mark>smLink1</mark>-<mark>smLink2</mark> <u>if we remove <mark>smLink1</mark> than <mark>file</mark>-<mark>smLink2</mark> are not linked any more</u>) </p>
    <p> - symbolic-links can be created to files or directories </p>
    <pre class="syntax">
SYNTAX :    <strong>fs</strong>.symlink(<strong>targPath:str|buf|urlObj</strong>, <strong>symLinkPath:str|buf|urlObj</strong>, <i class="openable">type:str<div>
                <p> <mark>'file'</mark> <mark>'dir'</mark> <mark>'junction'</mark>, if not set 'file' or 'dir' automatically detected / 'junction' = will resolve the <strong>targPath</strong> to absolute path (directory only) <u>(Windows only!)</u> </p>
            </div></i>, <strong>fs(err)</strong>)  // asynchronously creates a symbolic-link to a file or directory <u>(the target path (<strong>targPath</strong>) must be relative to the symbolic-link)</u>    
            <strong>fs</strong>.symlinkSync(<strong>targPath:str|buf|urlObj</strong>, <strong>symLinkPath:str|buf|urlObj</strong>, <i class="openable">type:str<div>
                <p> <mark>'file'</mark> <mark>'dir'</mark> <mark>'junction'</mark>, if not set 'file' or 'dir' automatically detected / 'junction' = will resolve the <strong>targPath</strong> to absolute path (directory only) <u>(Windows only!)</u> </p>
            </div></i>)       // synchronously creates a symbolic-link to a file or directory <u>(the target path (<strong>targPath</strong>) must be relative to the symbolic-link)</u>  
            
            <strong>fs</strong>.readlink(<strong>symLinkPath:str|buf|urlObj</strong>, <i>encode:str</i>, <strong>fs(err, link)</strong>)         // asynchronously returns the path where the symbolic-link is pointing to (in the callback)    
            <strong>fs</strong>.readlinkSync(<strong>symLinkPath:str|buf|urlObj</strong>, <i>encode:str</i>)                    // synchronously returns the path where the symbolic-link is pointing to    
    </pre>
<details class="example">
<summary> DEMO </summary>
    <pre>
    const fs = require("fs");
    
// link() / linkSync() ----------------------------------------------------------------// !! the 1st argument is a path what the symbolic-link uses to reference the file (therefore it's relative to the created symboli-link)   
    fs.symlinkSync('main.js', 'symbLink1');                                            // synchronously creates a symbolic link to the current directory 
    
    fs.symlink('../symbLink1', 'testDir/symbLink2', (err) => {                         // asynchronously creates a symbolic link in a subdirectory (symbolic-link to symbolic-link)   
        if(err) console.log(err);                                                      // -! 1st argument is the relative path from the created symbolic-link 
    });
    
// readlink() / readlinkSync() --------------------------------------------------------
    fs.readlinkSync('symbLink1');                                                      // -> 'main.js'              // synchronously returns where the symbolic-link points to  (current directory)
    
    fs.readlink('testDir/symbLink2', function(err, link){                              // asynchronously returns where the symbolic-link points to   
        if(err) console.log(err);
        link;                                                                          // -> '../symbLink1'         // points to the parent directory
    });    
    </pre>
</details>
<details class="example">
<summary> Example : </summary>
<h4 style="color:darkblue;"><u> <mark>link()</mark> / <mark>linkSync()</mark> / <mark>readlink()</mark> / readlinkSync() TEST </u></h4>
    <pre style="margin-bottom:1px;">
    const fs = require("fs");
    
// asynchronous ----------------------------------------------------------------------
    fs.symlink('./testFile.txt', './smLink_testFile.txt', function(err){              // symbolic link created in the same directory 
        if(err) console.log(err);
    });
    
    fs.symlink('../testFile.txt', 'testDir/smLink_testFile.txt', function(err){       // symbolic link created in the subdirectory (1st argument is relative to the created symbolic-link)
        if(err) console.log(err);
    });
    
    fs.symlink('./smLink_testFile.txt', 'testDir/smLink_testFile2.txt', function(err){  // symbolic-link created to another symbolic-link 
        if(err) console.log(err);
    });
    
// synchronous -----------------------------------------------------------------------
    fs.symlinkSync('./testDir', 'symDir');                                            // file symbolic-link   
    
    
// readlink() / readlinkSync() -------------------------------------------------------
    fs.readlink('testDir/smLink_testFile.txt', 'utf-8', function(err, link){          // returns the path where the symbolic-link points 
        if(err) console.log(err);
        console.log(link);                                                            // -> '..\testFile.txt'
    });
    
    console.log( fs.readlinkSync('testDir/smLink_testFile2.txt') );                   // -> '.\smLink_testFile.txt'
    
    </pre>
    <pre class="cmd" style="margin-top:1px;">
    PS D:\safe\code +\My Site\03 improuve\learn webdesign\04 node.js\file system\06 Hard-Link and Symbolic-Link\01 symlink() symlinkSync() readlink() readLinkSync() TEST> node main    
        .\smLink_testFile.txt
        ..\testFile.txt
    PS D:\safe\code +\My Site\03 improuve\learn webdesign\04 node.js\file system\06 Hard-Link and Symbolic-Link\01 symlink() symlinkSync() readlink() readLinkSync() TEST>    
    </pre>
<!----------------------------------------------------------------------------------------------------------------->
<hr>
<h4 style="color:darkblue;"><u> symbolic-link option argument TEST </u></h4>
    <p> - the <mark>file</mark> or <mark>dir</mark> type arguments are automatically detected </p>
    <p> - the <mark>'junction'</mark> type argument resolves the target path of the symbolic-link to absolute <u>(only for directory symbolic-links)</u>
    <pre style="margin-bottom:1px;">
    const fs = require("fs");
    
    fs.symlink('./main.js', 'smLink1.js', 'file', function(err){                      // type is automatically detected (putting 'dir' here won't work because this is a file [TESTED])   
        if(err) console.log(err);
        console.log( fs.readlinkSync('smLink1.js') );                                 // -> 'main.js'        // realative path 
    });

    fs.symlink('./', 'symlinkDir', 'junction', function(err){                         // type argument set to 'junction', this will resolve the target path (1st argument) as absolute path     
        if(err) console.log(err);
        console.log( fs.readlinkSync('symlinkDir') );                                 // -> 'D:\safe\code +\My Site\03 improuve\learn webdesign\04 node.js\file system\06 Hard-Link and Symbolic-Link\01.1 symbolic-link option argument TEST\main.js\'        
    });
    </pre>
    <pre class="cmd" style="margin-top:1px;">
    PS D:\safe\code +\My Site\03 improuve\learn webdesign\04 node.js\file system\06 Hard-Link and Symbolic-Link\01.1 symbolic-link option argument TEST> node main    
        .\main.js                                                                                                                                           // -! fs.readlinkSync('smLink1.js')
        D:\safe\code +\My Site\03 improuve\learn webdesign\04 node.js\file system\06 Hard-Link and Symbolic-Link\01.1 symbolic-link option argument TEST\   // -! fs.readlinkSync('symlinkDir')
    PS D:\safe\code +\My Site\03 improuve\learn webdesign\04 node.js\file system\06 Hard-Link and Symbolic-Link\01.1 symbolic-link option argument TEST>    
    </pre>
</details>
<!----------------------------------------------------------------------------------------------------------------->
<hr>
<h2 class="headerExtra"><u> Hard-Link </u></h2>
    <p> - Hard-Links are mirror copies of the original file (and each other), Hard-links and the original file are pointing to a same underlying data, <u>Hard-Links are available in the same volume (phisical disk)</u> </p>
    <p> - modifying the content of any of the hard-link files or the original file will modify the content of <u>all</u> files in the hard-link pool (because we modify the same underlying data) <u>(except deleting the file)</u> </p>
    <p> - in a hard-link pool  <mark>file1</mark>-<mark>file2</mark>-<mark>file3</mark>, <u>if we remove <mark>file2</mark> than <mark>file1</mark>-<mark>file3</mark> are still hard-linked)</u> <u>(files stay linked even if we remove the original file EX: removing <mark>file1</mark> than <mark>file2</mark>-<mark>file3</mark> stay linked </u></p>
    <p> - only file hard-links are allowed (directory hard-links are not allowed!) </p>
<h2 style="color:darkblue;"><u> The <mark>link()</mark> / <mark>linkSync()</mark> methods </u></h2>
    <pre class="syntax">
SYNTAX :    <strong>fs</strong>.link(<strong>path:str|buf|urlObj</strong>, <strong>hardLink:str|buf|urlObj</strong>, <strong>fn(err)</strong>)             // asynchronoulsy creates a hard-link of the original file (directory hard-links are not allowed)
            <strong>fs</strong>.linkSync(<strong>path:str|buf|urlObj</strong>, <strong>hardLink:str|buf|urlObj</strong>)                  // synchronously creates a hard-link of the original file (directory hard-links are not allowed)    
    </pre>
<details class="example">
<summary> DEMO </summary>
    <pre>
    const fs = require('fs');
    
    fs.linkSync('originalFile', 'link1');                                              // synchronously creates a hard-link of the original file 
    fs.link('link1', 'link2', (err) => { if(err) console.log(err); });                 // asynchronously creates a hard-link of another hard-link 
    
// ------------------------------------------------------------------------------------                     
    fs.statSync('originalFile').nlink;                                                 // -> 3              // -! modifying the content of 1 file will update the other 2 files automatically (except deleting the file)    
    fs.statSync('link1').nlink;                                                        // -> 3              // -! all 3 files have 3 hard-links (original file included) = files are webbed together not chained!    
    fs.statSync('link2').nlink;                                                        // -> 3              // -! no matter which file we deleted the other two will stay linked (even if we remove the original file)    
    </pre>
</details>
<details class="example">
<summary> Example : </summary>
<h4 style="color:darkblue;"><u> <mark>link()</mark> / <mark>linkSync()</mark> TEST </u></h4>
    <pre style="margin-bottom:1px;">
    const fs = require("fs");
    
    console.log( fs.statSync('testFile').nlink );                                      // -> 1             (1 file in the hard-link chain (no other file linked))
    
    fs.linkSync('testFile', 'link1');                                                  // synchronously creates a hard link 
    
    fs.link('testFile', 'link2', function(err){                                        // asynchronously creates a hard link 
        if(err) console.log(err);
        console.log( fs.statSync('testFile').nlink );                                  // -> 3             (3 files in the hard-link chain)
    });    
    </pre>
    <pre class="cmd" style="margin-top:1px;">
    PS D:\safe\code +\My Site\03 improuve\learn webdesign\04 node.js\file system\06 Hard-Link and Symbolic-Link\02 link() linkSync() TEST> node main    
        1                                                                              // -! fs.statSync('testFile').nlink
        3                                                                              // -! fs.statSync('testFile').nlink
    PS D:\safe\code +\My Site\03 improuve\learn webdesign\04 node.js\file system\06 Hard-Link and Symbolic-Link\02 link() linkSync() TEST>    
    </pre>
<!----------------------------------------------------------------------------------------------------------------->
<hr>
<h4 style="color:darkblue;"><u> placing hard-links in other than the current directory TEST </u></h4>
    <pre style="margin-bottom:1px;">
    const fs = require("fs");
    
    fs.linkSync('./testFile', './subDir/link1');                                       // hard-link created in the subdirectory 
    fs.linkSync('./testFile', '../link2');                                             // hard-link created in the parent directory 
    </pre>
    <pre class="cmd" style="margin-top:1px;">
    PS D:\safe\code +\My Site\03 improuve\learn webdesign\04 node.js\file system\06 Hard-Link and Symbolic-Link\02.1 placing hard-links in other than the current directory TEST\testDir> node main                                   
    PS D:\safe\code +\My Site\03 improuve\learn webdesign\04 node.js\file system\06 Hard-Link and Symbolic-Link\02.1 placing hard-links in other than the current directory TEST\testDir>    
    </pre>
<!----------------------------------------------------------------------------------------------------------------->
<hr>
<h4 style="color:darkblue;"><u> hard-link directories TEST </u></h4>
    <p style="color:yellow;"> - hard-linking directories is not allowed! </p>
    <pre style="margin-bottom:1px;">
    const fs = require("fs");
    
    fs.linkSync('testDir1', 'testDir2');                                               // throws an error (hard-linking directories not allowed)   
    </pre>
    <pre class="cmd" style="margin-top:1px;">
    PS D:\safe\code +\My Site\03 improuve\learn webdesign\04 node.js\file system\06 Hard-Link and Symbolic-Link\02.2 hard-link directories TEST> node main
        hard-link directories TEST> node main                                                                            
        fs.js:130
        throw err;
        ^
    
        Error: EPERM: operation not permitted, link 'testDir1' -> 'testDir2'
    PS D:\safe\code +\My Site\03 improuve\learn webdesign\04 node.js\file system\06 Hard-Link and Symbolic-Link\02.2 hard-link directories TEST>
    </pre>
<!----------------------------------------------------------------------------------------------------------------->
<hr>
<h4 style="color:darkblue;"><u> hard-link chain break TEST </u></h4>
    <pre style="margin-bottom:1px;">
    const fs = require("fs");
    
    fs.linkSync('testFile', 'link1');                                                  // creating a hard link chain 
    fs.linkSync('link1', 'link2');
    fs.linkSync('link2', 'link3');
    
    console.log( fs.statSync('testFile').nlink );                                      // -> 4          // all files have 4 hard-linked files in the chain (including the file itself)
    console.log( fs.statSync('link1').nlink );                                         // -> 4          // -! this means that each all the files are linked togeher = webbed not chained!
    console.log( fs.statSync('link2').nlink );                                         // -> 4
    console.log( fs.statSync('link3').nlink );                                         // -> 4  
    </pre>
    <pre class="cmd" style="margin-top:1px;">
    PS D:\safe\code +\My Site\03 improuve\learn webdesign\04 node.js\file system\06 Hard-Link and Symbolic-Link\02.3 hard-link chain break TEST> node main  
        4                                                                              // -! fs.statSync('testFile').nlink 
        4                                                                              // -! fs.statSync('link1').nlink 
        4                                                                              // -! fs.statSync('link2').nlink 
        4                                                                              // -! fs.statSync('link3').nlink 
    PS D:\safe\code +\My Site\03 improuve\learn webdesign\04 node.js\file system\06 Hard-Link and Symbolic-Link\02.3 hard-link chain break TEST> node main    
    </pre>
</details>


<br><br>
</body>
</html>